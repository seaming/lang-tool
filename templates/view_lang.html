{% extends 'base.html' %}

{% block title %}{{ lang.name }} language{% endblock %}

{% block body %}

<h2>{{ lang.name }}</h2>

<div class="lang-description">{{ (lang.description or 'No description found.')|markdown }}</div>

<br>
<hr><br>

<form action="{{ url_for('view_lang', code=lang.code) }}" method="GET">
  <div class="row center">
    <div class="col-8"><input class="small" type="text" name="q" placeholder="Search..." {% if request.args.get("q")
        %}value="{{ request.args.get("q") }}{% endif %}"></div>
    <div class="col-3 small">
      Sort by &thinsp;
      <select name="sort" class="small">
        <option value="nat" {% if request.args.get("sort")=="nat" %}selected{% endif %}>
          {{ lang.name or 'Unnamed language' }}
        </option>
        <option value="en" {% if request.args.get("sort")=="en" %}selected{% endif %}>English</option>
        <option value="pos" {% if request.args.get("sort")=="pos" %}selected{% endif %}>part of speech</option>
        {% if lang.use_classes %}
        <option value="class" {% if request.args.get("sort")=="class" %}selected{% endif %}>class</option>
        {% endif %}
      </select>
    </div>
    <div class="col-1"><input class="small" type="submit" value="üîé"></div>
  </div>
</form>

<table>
  <thead>
    <th>{{ lang.name or 'Unnamed language' }}</th>
    <th>English</th>
  </thead>
  <tbody>
    {% for word in words %}
    <tr class="clickable-row" href="{{ url_for('view_word', id=word.id.hex) }}" onclick="go_to_word(this);">
      <td>{{ word.nat }}</td>
      <td {% if word.definitions|map(attribute='en' )|join(';')|length> 50 %}class="small-text"{% endif %}>
        {% for d in word.definitions %}
        {{ d.en }} <span class="small text-muted">
          ({{ d.pos }}{% if d.classes %}; {{ d.classes|split(',')|join(', ')}}{% endif %})
        </span>
        {% endfor %}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}

{% block nav %}
<a href="{{ url_for('home') }}">üè†</a>
<a href="{{ url_for('edit_lang', code=lang.code) }}">‚úèÔ∏è</a>
<br><br>
<a href="{{ url_for('add_word', code=lang.code) }}">‚ûï</a>
{% endblock %}

{% block script %}
<script>
  function go_to_word(el) {
    location.href = el.getAttribute('href');
  }
</script>
{% endblock %}